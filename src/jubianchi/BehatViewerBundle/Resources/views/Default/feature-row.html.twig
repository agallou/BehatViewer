{% set steps = feature.getStepsHavingStatusCount() %}

{% if steps > 0 %}
{% set passed = feature.getStepsHavingStatusCount('passed') %}
{% set passedpcnt = ((passed / steps) * 100)|round(3) %}

{% set failed = feature.getStepsHavingStatusCount('failed') %}
{% set failedpcnt = ((failed / steps) * 100)|round(3) %}

{% set skipped = feature.getStepsHavingStatusCount('skipped') %}
{% set skippedpcnt = ((skipped / steps) * 100)|round(3) %}

{% set undefined = feature.getStepsHavingStatusCount('undefined') %}
{% set undefinedpcnt = ((undefined / steps) * 100)|round(3) %}

{% set pending = feature.getStepsHavingStatusCount('pending') %}
{% set pendingpcnt = ((pending / steps) * 100)|round(3) %}
{% endif %}

<tr class="navig">
    <td>
        <strong>{{ feature.name }}</strong>
        {% if feature.tags|count > 0 %}
            <br/>
            {% for tag in feature.tags %}
                <a href="{{ path("behatviewer.tag", {slug: tag.slug}) }}" class="label label-info"> {{ tag.name }} </a>&nbsp;
            {% endfor %}
        {% endif %}
    </td>
    <td style="width: 10%">{% if steps > 0 %}{{ passedpcnt|round }}{% else %}0{% endif %}%</td>
    <td style="min-width: 250px; width: 25%" data-value="{% if steps > 0 %}{{ passedpcnt|round }}{% else %}0{% endif %}">
        {%
            include 'BehatViewerBundle::Components/progress.html.twig'
            with {
                'passed': feature.getStepsHavingStatusCount('passed'),
                'failed': feature.getStepsHavingStatusCount('failed'),
                'skipped': feature.getStepsHavingStatusCount('skipped') + feature.getStepsHavingStatusCount('pending'),
                'undefined': feature.getStepsHavingStatusCount('undefined')
            }
        %}
    </td>
    <td data-value="{{ steps }}">
        <ul class="pull-left">
            {% if steps > 0 %}
            {% if passed > 0 %}
            <li><span class="success" style="color: #62C462; font-weight: bold">Passed: {{ passed }}/{{ steps }} ({{ passedpcnt|round }}%)</span>
            </li>
            {% endif %}
            {% if failed > 0 %}
            <li><span class="danger" style="color: #EE5F5B; font-weight: bold">Failed: {{ failed }}/{{ steps }} ({{ failedpcnt|round }}%)</span>
            </li>
            {% endif %}
            {% if skipped > 0 %}
            <li><span class="info" style="color: #5BC0DE; font-weight: bold">Skipped: {{ skipped }}/{{ steps }} ({{ skippedpcnt|round }}%)</span>
            </li>
            {% endif %}
            {% if pending > 0 %}
            <li><span class="info" style="color: #5BC0DE; font-weight: bold">Pending: {{ pending }}/{{ steps }} ({{ pendingpcnt|round }}%)</span>
            </li>
            {% endif %}
            {% if undefined > 0 %}
            <li><span class="warning" style="color: #FBB450; font-weight: bold">Undefined: {{ undefined }}/{{ steps }} ({{ undefinedpcnt|round }}%)</span>
            </li>
            {% endif %}
            {% endif %}
        </ul>
    </td>
    <td class="action">
        <a class="btn" href="{{ path('behatviewer.feature', {'id': feature.id, 'slug':feature.slug}) }}">Details &raquo;</a>
    </td>
</tr>
